{"ast":null,"code":"import '../utils/click/isClickableInput.js';\nimport '../utils/dataTransfer/Clipboard.js';\nimport '../utils/edit/isEditable.js';\nimport '../utils/edit/maxLength.js';\nimport { isElementType } from '../utils/misc/isElementType.js';\nimport '@testing-library/dom/dist/helpers.js';\nimport '../utils/keyDef/readNextDescriptor.js';\nimport '../utils/misc/level.js';\nimport '../options.js';\nimport { startTrackValue, trackOrSetValue } from './trackValue.js';\nimport { setUISelectionClean, setUISelectionRaw, getUIValue, setUIValueClean, isUIValue, isUISelectionStart } from './UI.js';\nconst Interceptor = Symbol('Interceptor for programmatical calls');\nfunction prepareInterceptor(element, propName, interceptorImpl) {\n  const prototypeDescriptor = Object.getOwnPropertyDescriptor(element.constructor.prototype, propName);\n  const objectDescriptor = Object.getOwnPropertyDescriptor(element, propName);\n  const target = (prototypeDescriptor === null || prototypeDescriptor === void 0 ? void 0 : prototypeDescriptor.set) ? 'set' : 'value';\n  /* istanbul ignore if */\n  if (typeof (prototypeDescriptor === null || prototypeDescriptor === void 0 ? void 0 : prototypeDescriptor[target]) !== 'function' || prototypeDescriptor[target][Interceptor]) {\n    throw new Error(`Element ${element.tagName} does not implement \"${String(propName)}\".`);\n  }\n  function intercept(...args) {\n    const {\n      applyNative = false,\n      realArgs,\n      then\n    } = interceptorImpl.call(this, ...args);\n    const realFunc = (!applyNative && objectDescriptor || prototypeDescriptor)[target];\n    if (target === 'set') {\n      realFunc.call(this, realArgs);\n    } else {\n      realFunc.call(this, ...realArgs);\n    }\n    then === null || then === void 0 ? void 0 : then();\n  }\n  intercept[Interceptor] = Interceptor;\n  Object.defineProperty(element, propName, {\n    ...(objectDescriptor !== null && objectDescriptor !== void 0 ? objectDescriptor : prototypeDescriptor),\n    [target]: intercept\n  });\n}\nfunction prepareValueInterceptor(element) {\n  prepareInterceptor(element, 'value', function interceptorImpl(v) {\n    const isUI = isUIValue(v);\n    if (isUI) {\n      startTrackValue(this);\n    }\n    return {\n      applyNative: !!isUI,\n      realArgs: sanitizeValue(this, v),\n      then: isUI ? undefined : () => trackOrSetValue(this, String(v))\n    };\n  });\n}\nfunction sanitizeValue(element, v) {\n  // Workaround for JSDOM\n  if (isElementType(element, 'input', {\n    type: 'number'\n  }) && String(v) !== '' && !Number.isNaN(Number(v))) {\n    // Setting value to \"1.\" results in `null` in JSDOM\n    return String(Number(v));\n  }\n  return String(v);\n}\nfunction prepareSelectionInterceptor(element) {\n  prepareInterceptor(element, 'setSelectionRange', function interceptorImpl(start, ...others) {\n    const isUI = isUISelectionStart(start);\n    return {\n      applyNative: !!isUI,\n      realArgs: [Number(start), ...others],\n      then: () => isUI ? undefined : setUISelectionClean(element)\n    };\n  });\n  prepareInterceptor(element, 'selectionStart', function interceptorImpl(v) {\n    return {\n      realArgs: v,\n      then: () => setUISelectionClean(element)\n    };\n  });\n  prepareInterceptor(element, 'selectionEnd', function interceptorImpl(v) {\n    return {\n      realArgs: v,\n      then: () => setUISelectionClean(element)\n    };\n  });\n  prepareInterceptor(element, 'select', function interceptorImpl() {\n    return {\n      realArgs: [],\n      then: () => setUISelectionRaw(element, {\n        anchorOffset: 0,\n        focusOffset: getUIValue(element).length\n      })\n    };\n  });\n}\nfunction prepareRangeTextInterceptor(element) {\n  prepareInterceptor(element, 'setRangeText', function interceptorImpl(...realArgs) {\n    return {\n      realArgs,\n      then: () => {\n        setUIValueClean(element);\n        setUISelectionClean(element);\n      }\n    };\n  });\n}\nexport { prepareInterceptor, prepareRangeTextInterceptor, prepareSelectionInterceptor, prepareValueInterceptor };","map":{"version":3,"names":["isElementType","startTrackValue","trackOrSetValue","setUISelectionClean","setUISelectionRaw","getUIValue","setUIValueClean","isUIValue","isUISelectionStart","Interceptor","Symbol","prepareInterceptor","element","propName","interceptorImpl","prototypeDescriptor","Object","getOwnPropertyDescriptor","constructor","prototype","objectDescriptor","target","set","Error","tagName","String","intercept","args","applyNative","realArgs","then","call","realFunc","defineProperty","prepareValueInterceptor","v","isUI","sanitizeValue","undefined","type","Number","isNaN","prepareSelectionInterceptor","start","others","anchorOffset","focusOffset","length","prepareRangeTextInterceptor"],"sources":["C:/Users/drevo/Documents/GitHub/Crafts/TypeScript/Storybook/node_modules/@testing-library/user-event/dist/esm/document/interceptor.js"],"sourcesContent":["import '../utils/click/isClickableInput.js';\nimport '../utils/dataTransfer/Clipboard.js';\nimport '../utils/edit/isEditable.js';\nimport '../utils/edit/maxLength.js';\nimport { isElementType } from '../utils/misc/isElementType.js';\nimport '@testing-library/dom/dist/helpers.js';\nimport '../utils/keyDef/readNextDescriptor.js';\nimport '../utils/misc/level.js';\nimport '../options.js';\nimport { startTrackValue, trackOrSetValue } from './trackValue.js';\nimport { setUISelectionClean, setUISelectionRaw, getUIValue, setUIValueClean, isUIValue, isUISelectionStart } from './UI.js';\n\nconst Interceptor = Symbol('Interceptor for programmatical calls');\nfunction prepareInterceptor(element, propName, interceptorImpl) {\n    const prototypeDescriptor = Object.getOwnPropertyDescriptor(element.constructor.prototype, propName);\n    const objectDescriptor = Object.getOwnPropertyDescriptor(element, propName);\n    const target = (prototypeDescriptor === null || prototypeDescriptor === void 0 ? void 0 : prototypeDescriptor.set) ? 'set' : 'value';\n    /* istanbul ignore if */ if (typeof (prototypeDescriptor === null || prototypeDescriptor === void 0 ? void 0 : prototypeDescriptor[target]) !== 'function' || prototypeDescriptor[target][Interceptor]) {\n        throw new Error(`Element ${element.tagName} does not implement \"${String(propName)}\".`);\n    }\n    function intercept(...args) {\n        const { applyNative = false, realArgs, then } = interceptorImpl.call(this, ...args);\n        const realFunc = (!applyNative && objectDescriptor || prototypeDescriptor)[target];\n        if (target === 'set') {\n            realFunc.call(this, realArgs);\n        } else {\n            realFunc.call(this, ...realArgs);\n        }\n        then === null || then === void 0 ? void 0 : then();\n    }\n    intercept[Interceptor] = Interceptor;\n    Object.defineProperty(element, propName, {\n        ...objectDescriptor !== null && objectDescriptor !== void 0 ? objectDescriptor : prototypeDescriptor,\n        [target]: intercept\n    });\n}\nfunction prepareValueInterceptor(element) {\n    prepareInterceptor(element, 'value', function interceptorImpl(v) {\n        const isUI = isUIValue(v);\n        if (isUI) {\n            startTrackValue(this);\n        }\n        return {\n            applyNative: !!isUI,\n            realArgs: sanitizeValue(this, v),\n            then: isUI ? undefined : ()=>trackOrSetValue(this, String(v))\n        };\n    });\n}\nfunction sanitizeValue(element, v) {\n    // Workaround for JSDOM\n    if (isElementType(element, 'input', {\n        type: 'number'\n    }) && String(v) !== '' && !Number.isNaN(Number(v))) {\n        // Setting value to \"1.\" results in `null` in JSDOM\n        return String(Number(v));\n    }\n    return String(v);\n}\nfunction prepareSelectionInterceptor(element) {\n    prepareInterceptor(element, 'setSelectionRange', function interceptorImpl(start, ...others) {\n        const isUI = isUISelectionStart(start);\n        return {\n            applyNative: !!isUI,\n            realArgs: [\n                Number(start),\n                ...others\n            ],\n            then: ()=>isUI ? undefined : setUISelectionClean(element)\n        };\n    });\n    prepareInterceptor(element, 'selectionStart', function interceptorImpl(v) {\n        return {\n            realArgs: v,\n            then: ()=>setUISelectionClean(element)\n        };\n    });\n    prepareInterceptor(element, 'selectionEnd', function interceptorImpl(v) {\n        return {\n            realArgs: v,\n            then: ()=>setUISelectionClean(element)\n        };\n    });\n    prepareInterceptor(element, 'select', function interceptorImpl() {\n        return {\n            realArgs: [],\n            then: ()=>setUISelectionRaw(element, {\n                    anchorOffset: 0,\n                    focusOffset: getUIValue(element).length\n                })\n        };\n    });\n}\nfunction prepareRangeTextInterceptor(element) {\n    prepareInterceptor(element, 'setRangeText', function interceptorImpl(...realArgs) {\n        return {\n            realArgs,\n            then: ()=>{\n                setUIValueClean(element);\n                setUISelectionClean(element);\n            }\n        };\n    });\n}\n\nexport { prepareInterceptor, prepareRangeTextInterceptor, prepareSelectionInterceptor, prepareValueInterceptor };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}