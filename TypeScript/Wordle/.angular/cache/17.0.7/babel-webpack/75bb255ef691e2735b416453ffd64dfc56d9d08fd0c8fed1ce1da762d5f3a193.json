{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/drevo/Documents/GitHub/Crafts/TypeScript/Storybook/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport '../utils/click/isClickableInput.js';\nimport '../utils/dataTransfer/Clipboard.js';\nimport '../utils/edit/isEditable.js';\nimport '../utils/edit/maxLength.js';\nimport { getActiveElementOrBody } from '../utils/focus/getActiveElement.js';\nimport '@testing-library/dom/dist/helpers.js';\nimport '../utils/keyDef/readNextDescriptor.js';\nimport '../utils/misc/level.js';\nimport '../options.js';\nfunction _define_property(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nvar DOM_KEY_LOCATION;\n(function (DOM_KEY_LOCATION) {\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"STANDARD\"] = 0] = \"STANDARD\";\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"LEFT\"] = 1] = \"LEFT\";\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"RIGHT\"] = 2] = \"RIGHT\";\n  DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"NUMPAD\"] = 3] = \"NUMPAD\";\n})(DOM_KEY_LOCATION || (DOM_KEY_LOCATION = {}));\nconst modifierKeys = ['Alt', 'AltGraph', 'Control', 'Fn', 'Meta', 'Shift', 'Symbol'];\nfunction isModifierKey(key) {\n  return modifierKeys.includes(key);\n}\nconst modifierLocks = ['CapsLock', 'FnLock', 'NumLock', 'ScrollLock', 'SymbolLock'];\nfunction isModifierLock(key) {\n  return modifierLocks.includes(key);\n}\nclass KeyboardHost {\n  isKeyPressed(keyDef) {\n    return !!this.pressed[String(keyDef.code)];\n  }\n  getPressedKeys() {\n    return Object.values(this.pressed).map(p => p.keyDef);\n  }\n  /** Press a key */\n  keydown(instance, keyDef) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        _this_pressed, _code, _this_pressed_code;\n      const key = String(keyDef.key);\n      const code = String(keyDef.code);\n      const target = getActiveElementOrBody(instance.config.document);\n      _this.setKeydownTarget(target);\n      var _;\n      (_ = (_this_pressed = _this.pressed)[_code = code]) !== null && _ !== void 0 ? _ : _this_pressed[_code] = {\n        keyDef,\n        unpreventedDefault: false\n      };\n      if (isModifierKey(key)) {\n        _this.modifiers[key] = true;\n      }\n      const unprevented = instance.dispatchUIEvent(target, 'keydown', {\n        key,\n        code\n      });\n      if (isModifierLock(key) && !_this.modifiers[key]) {\n        _this.modifiers[key] = true;\n        _this.modifierLockStart[key] = true;\n      }\n      (_this_pressed_code = _this.pressed[code]).unpreventedDefault || (_this_pressed_code.unpreventedDefault = unprevented);\n      if (unprevented && _this.hasKeyPress(key)) {\n        instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keypress', {\n          key,\n          code,\n          charCode: keyDef.key === 'Enter' ? 13 : String(keyDef.key).charCodeAt(0)\n        });\n      }\n    })();\n  }\n  /** Release a key */\n  keyup(instance, keyDef) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const key = String(keyDef.key);\n      const code = String(keyDef.code);\n      const unprevented = _this2.pressed[code].unpreventedDefault;\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete _this2.pressed[code];\n      if (isModifierKey(key) && !Object.values(_this2.pressed).find(p => p.keyDef.key === key)) {\n        _this2.modifiers[key] = false;\n      }\n      instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keyup', {\n        key,\n        code\n      }, !unprevented);\n      if (isModifierLock(key) && _this2.modifiers[key]) {\n        if (_this2.modifierLockStart[key]) {\n          _this2.modifierLockStart[key] = false;\n        } else {\n          _this2.modifiers[key] = false;\n        }\n      }\n    })();\n  }\n  setKeydownTarget(target) {\n    if (target !== this.lastKeydownTarget) {\n      this.carryChar = '';\n    }\n    this.lastKeydownTarget = target;\n  }\n  hasKeyPress(key) {\n    return (key.length === 1 || key === 'Enter') && !this.modifiers.Control && !this.modifiers.Alt;\n  }\n  constructor(system) {\n    _define_property(this, \"system\", void 0);\n    _define_property(this, \"modifiers\", {\n      Alt: false,\n      AltGraph: false,\n      CapsLock: false,\n      Control: false,\n      Fn: false,\n      FnLock: false,\n      Meta: false,\n      NumLock: false,\n      ScrollLock: false,\n      Shift: false,\n      Symbol: false,\n      SymbolLock: false\n    });\n    _define_property(this, \"pressed\", {});\n    _define_property(this, \"carryChar\", '');\n    _define_property(this, \"lastKeydownTarget\", undefined);\n    _define_property(this, \"modifierLockStart\", {});\n    this.system = system;\n  }\n}\nexport { DOM_KEY_LOCATION, KeyboardHost };","map":{"version":3,"names":["getActiveElementOrBody","_define_property","obj","key","value","Object","defineProperty","enumerable","configurable","writable","DOM_KEY_LOCATION","modifierKeys","isModifierKey","includes","modifierLocks","isModifierLock","KeyboardHost","isKeyPressed","keyDef","pressed","String","code","getPressedKeys","values","map","p","keydown","instance","_this","_asyncToGenerator","_this_pressed","_code","_this_pressed_code","target","config","document","setKeydownTarget","_","unpreventedDefault","modifiers","unprevented","dispatchUIEvent","modifierLockStart","hasKeyPress","charCode","charCodeAt","keyup","_this2","find","lastKeydownTarget","carryChar","length","Control","Alt","constructor","system","AltGraph","CapsLock","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock","undefined"],"sources":["C:/Users/drevo/Documents/GitHub/Crafts/TypeScript/Storybook/node_modules/@testing-library/user-event/dist/esm/system/keyboard.js"],"sourcesContent":["import '../utils/click/isClickableInput.js';\nimport '../utils/dataTransfer/Clipboard.js';\nimport '../utils/edit/isEditable.js';\nimport '../utils/edit/maxLength.js';\nimport { getActiveElementOrBody } from '../utils/focus/getActiveElement.js';\nimport '@testing-library/dom/dist/helpers.js';\nimport '../utils/keyDef/readNextDescriptor.js';\nimport '../utils/misc/level.js';\nimport '../options.js';\n\nfunction _define_property(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true\n        });\n    } else {\n        obj[key] = value;\n    }\n    return obj;\n}\nvar DOM_KEY_LOCATION;\n(function(DOM_KEY_LOCATION) {\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"STANDARD\"] = 0] = \"STANDARD\";\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"LEFT\"] = 1] = \"LEFT\";\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"RIGHT\"] = 2] = \"RIGHT\";\n    DOM_KEY_LOCATION[DOM_KEY_LOCATION[\"NUMPAD\"] = 3] = \"NUMPAD\";\n})(DOM_KEY_LOCATION || (DOM_KEY_LOCATION = {}));\nconst modifierKeys = [\n    'Alt',\n    'AltGraph',\n    'Control',\n    'Fn',\n    'Meta',\n    'Shift',\n    'Symbol'\n];\nfunction isModifierKey(key) {\n    return modifierKeys.includes(key);\n}\nconst modifierLocks = [\n    'CapsLock',\n    'FnLock',\n    'NumLock',\n    'ScrollLock',\n    'SymbolLock'\n];\nfunction isModifierLock(key) {\n    return modifierLocks.includes(key);\n}\nclass KeyboardHost {\n    isKeyPressed(keyDef) {\n        return !!this.pressed[String(keyDef.code)];\n    }\n    getPressedKeys() {\n        return Object.values(this.pressed).map((p)=>p.keyDef);\n    }\n    /** Press a key */ async keydown(instance, keyDef) {\n        var // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        _this_pressed, _code, _this_pressed_code;\n        const key = String(keyDef.key);\n        const code = String(keyDef.code);\n        const target = getActiveElementOrBody(instance.config.document);\n        this.setKeydownTarget(target);\n        var _;\n        (_ = (_this_pressed = this.pressed)[_code = code]) !== null && _ !== void 0 ? _ : _this_pressed[_code] = {\n            keyDef,\n            unpreventedDefault: false\n        };\n        if (isModifierKey(key)) {\n            this.modifiers[key] = true;\n        }\n        const unprevented = instance.dispatchUIEvent(target, 'keydown', {\n            key,\n            code\n        });\n        if (isModifierLock(key) && !this.modifiers[key]) {\n            this.modifiers[key] = true;\n            this.modifierLockStart[key] = true;\n        }\n        (_this_pressed_code = this.pressed[code]).unpreventedDefault || (_this_pressed_code.unpreventedDefault = unprevented);\n        if (unprevented && this.hasKeyPress(key)) {\n            instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keypress', {\n                key,\n                code,\n                charCode: keyDef.key === 'Enter' ? 13 : String(keyDef.key).charCodeAt(0)\n            });\n        }\n    }\n    /** Release a key */ async keyup(instance, keyDef) {\n        const key = String(keyDef.key);\n        const code = String(keyDef.code);\n        const unprevented = this.pressed[code].unpreventedDefault;\n        // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n        delete this.pressed[code];\n        if (isModifierKey(key) && !Object.values(this.pressed).find((p)=>p.keyDef.key === key)) {\n            this.modifiers[key] = false;\n        }\n        instance.dispatchUIEvent(getActiveElementOrBody(instance.config.document), 'keyup', {\n            key,\n            code\n        }, !unprevented);\n        if (isModifierLock(key) && this.modifiers[key]) {\n            if (this.modifierLockStart[key]) {\n                this.modifierLockStart[key] = false;\n            } else {\n                this.modifiers[key] = false;\n            }\n        }\n    }\n    setKeydownTarget(target) {\n        if (target !== this.lastKeydownTarget) {\n            this.carryChar = '';\n        }\n        this.lastKeydownTarget = target;\n    }\n    hasKeyPress(key) {\n        return (key.length === 1 || key === 'Enter') && !this.modifiers.Control && !this.modifiers.Alt;\n    }\n    constructor(system){\n        _define_property(this, \"system\", void 0);\n        _define_property(this, \"modifiers\", {\n            Alt: false,\n            AltGraph: false,\n            CapsLock: false,\n            Control: false,\n            Fn: false,\n            FnLock: false,\n            Meta: false,\n            NumLock: false,\n            ScrollLock: false,\n            Shift: false,\n            Symbol: false,\n            SymbolLock: false\n        });\n        _define_property(this, \"pressed\", {});\n        _define_property(this, \"carryChar\", '');\n        _define_property(this, \"lastKeydownTarget\", undefined);\n        _define_property(this, \"modifierLockStart\", {});\n        this.system = system;\n    }\n}\n\nexport { DOM_KEY_LOCATION, KeyboardHost };\n"],"mappings":";AAAA,OAAO,oCAAoC;AAC3C,OAAO,oCAAoC;AAC3C,OAAO,6BAA6B;AACpC,OAAO,4BAA4B;AACnC,SAASA,sBAAsB,QAAQ,oCAAoC;AAC3E,OAAO,sCAAsC;AAC7C,OAAO,uCAAuC;AAC9C,OAAO,wBAAwB;AAC/B,OAAO,eAAe;AAEtB,SAASC,gBAAgBA,CAACC,GAAG,EAAEC,GAAG,EAAEC,KAAK,EAAE;EACvC,IAAID,GAAG,IAAID,GAAG,EAAE;IACZG,MAAM,CAACC,cAAc,CAACJ,GAAG,EAAEC,GAAG,EAAE;MAC5BC,KAAK,EAAEA,KAAK;MACZG,UAAU,EAAE,IAAI;MAChBC,YAAY,EAAE,IAAI;MAClBC,QAAQ,EAAE;IACd,CAAC,CAAC;EACN,CAAC,MAAM;IACHP,GAAG,CAACC,GAAG,CAAC,GAAGC,KAAK;EACpB;EACA,OAAOF,GAAG;AACd;AACA,IAAIQ,gBAAgB;AACpB,CAAC,UAASA,gBAAgB,EAAE;EACxBA,gBAAgB,CAACA,gBAAgB,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU;EAC/DA,gBAAgB,CAACA,gBAAgB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM;EACvDA,gBAAgB,CAACA,gBAAgB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GAAG,OAAO;EACzDA,gBAAgB,CAACA,gBAAgB,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,GAAG,QAAQ;AAC/D,CAAC,EAAEA,gBAAgB,KAAKA,gBAAgB,GAAG,CAAC,CAAC,CAAC,CAAC;AAC/C,MAAMC,YAAY,GAAG,CACjB,KAAK,EACL,UAAU,EACV,SAAS,EACT,IAAI,EACJ,MAAM,EACN,OAAO,EACP,QAAQ,CACX;AACD,SAASC,aAAaA,CAACT,GAAG,EAAE;EACxB,OAAOQ,YAAY,CAACE,QAAQ,CAACV,GAAG,CAAC;AACrC;AACA,MAAMW,aAAa,GAAG,CAClB,UAAU,EACV,QAAQ,EACR,SAAS,EACT,YAAY,EACZ,YAAY,CACf;AACD,SAASC,cAAcA,CAACZ,GAAG,EAAE;EACzB,OAAOW,aAAa,CAACD,QAAQ,CAACV,GAAG,CAAC;AACtC;AACA,MAAMa,YAAY,CAAC;EACfC,YAAYA,CAACC,MAAM,EAAE;IACjB,OAAO,CAAC,CAAC,IAAI,CAACC,OAAO,CAACC,MAAM,CAACF,MAAM,CAACG,IAAI,CAAC,CAAC;EAC9C;EACAC,cAAcA,CAAA,EAAG;IACb,OAAOjB,MAAM,CAACkB,MAAM,CAAC,IAAI,CAACJ,OAAO,CAAC,CAACK,GAAG,CAAEC,CAAC,IAAGA,CAAC,CAACP,MAAM,CAAC;EACzD;EACA;EAAyBQ,OAAOA,CAACC,QAAQ,EAAET,MAAM,EAAE;IAAA,IAAAU,KAAA;IAAA,OAAAC,iBAAA;MAC/C;QAAI;QACJC,aAAa,EAAEC,KAAK,EAAEC,kBAAkB;MACxC,MAAM7B,GAAG,GAAGiB,MAAM,CAACF,MAAM,CAACf,GAAG,CAAC;MAC9B,MAAMkB,IAAI,GAAGD,MAAM,CAACF,MAAM,CAACG,IAAI,CAAC;MAChC,MAAMY,MAAM,GAAGjC,sBAAsB,CAAC2B,QAAQ,CAACO,MAAM,CAACC,QAAQ,CAAC;MAC/DP,KAAI,CAACQ,gBAAgB,CAACH,MAAM,CAAC;MAC7B,IAAII,CAAC;MACL,CAACA,CAAC,GAAG,CAACP,aAAa,GAAGF,KAAI,CAACT,OAAO,EAAEY,KAAK,GAAGV,IAAI,CAAC,MAAM,IAAI,IAAIgB,CAAC,KAAK,KAAK,CAAC,GAAGA,CAAC,GAAGP,aAAa,CAACC,KAAK,CAAC,GAAG;QACrGb,MAAM;QACNoB,kBAAkB,EAAE;MACxB,CAAC;MACD,IAAI1B,aAAa,CAACT,GAAG,CAAC,EAAE;QACpByB,KAAI,CAACW,SAAS,CAACpC,GAAG,CAAC,GAAG,IAAI;MAC9B;MACA,MAAMqC,WAAW,GAAGb,QAAQ,CAACc,eAAe,CAACR,MAAM,EAAE,SAAS,EAAE;QAC5D9B,GAAG;QACHkB;MACJ,CAAC,CAAC;MACF,IAAIN,cAAc,CAACZ,GAAG,CAAC,IAAI,CAACyB,KAAI,CAACW,SAAS,CAACpC,GAAG,CAAC,EAAE;QAC7CyB,KAAI,CAACW,SAAS,CAACpC,GAAG,CAAC,GAAG,IAAI;QAC1ByB,KAAI,CAACc,iBAAiB,CAACvC,GAAG,CAAC,GAAG,IAAI;MACtC;MACA,CAAC6B,kBAAkB,GAAGJ,KAAI,CAACT,OAAO,CAACE,IAAI,CAAC,EAAEiB,kBAAkB,KAAKN,kBAAkB,CAACM,kBAAkB,GAAGE,WAAW,CAAC;MACrH,IAAIA,WAAW,IAAIZ,KAAI,CAACe,WAAW,CAACxC,GAAG,CAAC,EAAE;QACtCwB,QAAQ,CAACc,eAAe,CAACzC,sBAAsB,CAAC2B,QAAQ,CAACO,MAAM,CAACC,QAAQ,CAAC,EAAE,UAAU,EAAE;UACnFhC,GAAG;UACHkB,IAAI;UACJuB,QAAQ,EAAE1B,MAAM,CAACf,GAAG,KAAK,OAAO,GAAG,EAAE,GAAGiB,MAAM,CAACF,MAAM,CAACf,GAAG,CAAC,CAAC0C,UAAU,CAAC,CAAC;QAC3E,CAAC,CAAC;MACN;IAAC;EACL;EACA;EAA2BC,KAAKA,CAACnB,QAAQ,EAAET,MAAM,EAAE;IAAA,IAAA6B,MAAA;IAAA,OAAAlB,iBAAA;MAC/C,MAAM1B,GAAG,GAAGiB,MAAM,CAACF,MAAM,CAACf,GAAG,CAAC;MAC9B,MAAMkB,IAAI,GAAGD,MAAM,CAACF,MAAM,CAACG,IAAI,CAAC;MAChC,MAAMmB,WAAW,GAAGO,MAAI,CAAC5B,OAAO,CAACE,IAAI,CAAC,CAACiB,kBAAkB;MACzD;MACA,OAAOS,MAAI,CAAC5B,OAAO,CAACE,IAAI,CAAC;MACzB,IAAIT,aAAa,CAACT,GAAG,CAAC,IAAI,CAACE,MAAM,CAACkB,MAAM,CAACwB,MAAI,CAAC5B,OAAO,CAAC,CAAC6B,IAAI,CAAEvB,CAAC,IAAGA,CAAC,CAACP,MAAM,CAACf,GAAG,KAAKA,GAAG,CAAC,EAAE;QACpF4C,MAAI,CAACR,SAAS,CAACpC,GAAG,CAAC,GAAG,KAAK;MAC/B;MACAwB,QAAQ,CAACc,eAAe,CAACzC,sBAAsB,CAAC2B,QAAQ,CAACO,MAAM,CAACC,QAAQ,CAAC,EAAE,OAAO,EAAE;QAChFhC,GAAG;QACHkB;MACJ,CAAC,EAAE,CAACmB,WAAW,CAAC;MAChB,IAAIzB,cAAc,CAACZ,GAAG,CAAC,IAAI4C,MAAI,CAACR,SAAS,CAACpC,GAAG,CAAC,EAAE;QAC5C,IAAI4C,MAAI,CAACL,iBAAiB,CAACvC,GAAG,CAAC,EAAE;UAC7B4C,MAAI,CAACL,iBAAiB,CAACvC,GAAG,CAAC,GAAG,KAAK;QACvC,CAAC,MAAM;UACH4C,MAAI,CAACR,SAAS,CAACpC,GAAG,CAAC,GAAG,KAAK;QAC/B;MACJ;IAAC;EACL;EACAiC,gBAAgBA,CAACH,MAAM,EAAE;IACrB,IAAIA,MAAM,KAAK,IAAI,CAACgB,iBAAiB,EAAE;MACnC,IAAI,CAACC,SAAS,GAAG,EAAE;IACvB;IACA,IAAI,CAACD,iBAAiB,GAAGhB,MAAM;EACnC;EACAU,WAAWA,CAACxC,GAAG,EAAE;IACb,OAAO,CAACA,GAAG,CAACgD,MAAM,KAAK,CAAC,IAAIhD,GAAG,KAAK,OAAO,KAAK,CAAC,IAAI,CAACoC,SAAS,CAACa,OAAO,IAAI,CAAC,IAAI,CAACb,SAAS,CAACc,GAAG;EAClG;EACAC,WAAWA,CAACC,MAAM,EAAC;IACftD,gBAAgB,CAAC,IAAI,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;IACxCA,gBAAgB,CAAC,IAAI,EAAE,WAAW,EAAE;MAChCoD,GAAG,EAAE,KAAK;MACVG,QAAQ,EAAE,KAAK;MACfC,QAAQ,EAAE,KAAK;MACfL,OAAO,EAAE,KAAK;MACdM,EAAE,EAAE,KAAK;MACTC,MAAM,EAAE,KAAK;MACbC,IAAI,EAAE,KAAK;MACXC,OAAO,EAAE,KAAK;MACdC,UAAU,EAAE,KAAK;MACjBC,KAAK,EAAE,KAAK;MACZC,MAAM,EAAE,KAAK;MACbC,UAAU,EAAE;IAChB,CAAC,CAAC;IACFhE,gBAAgB,CAAC,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;IACrCA,gBAAgB,CAAC,IAAI,EAAE,WAAW,EAAE,EAAE,CAAC;IACvCA,gBAAgB,CAAC,IAAI,EAAE,mBAAmB,EAAEiE,SAAS,CAAC;IACtDjE,gBAAgB,CAAC,IAAI,EAAE,mBAAmB,EAAE,CAAC,CAAC,CAAC;IAC/C,IAAI,CAACsD,MAAM,GAAGA,MAAM;EACxB;AACJ;AAEA,SAAS7C,gBAAgB,EAAEM,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}